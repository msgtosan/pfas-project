============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0 -- /home/sshankar/projects/pfas-project/venv/bin/python3
cachedir: .pytest_cache
rootdir: /home/sshankar/projects/pfas-project
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 1219 items

tests/integration/test_audit_triggers.py::TestAutomaticAuditTriggers::test_journal_insert_trigger PASSED [  0%]
tests/integration/test_audit_triggers.py::TestAutomaticAuditTriggers::test_journal_update_trigger PASSED [  0%]
tests/integration/test_audit_triggers.py::TestAutomaticAuditTriggers::test_journal_entries_trigger PASSED [  0%]
tests/integration/test_audit_triggers.py::TestAutomaticAuditTriggers::test_exchange_rates_trigger PASSED [  0%]
tests/integration/test_audit_triggers.py::TestAutomaticAuditTriggers::test_accounts_trigger PASSED [  0%]
tests/integration/test_audit_triggers.py::TestAutomaticAuditTriggers::test_bank_accounts_trigger PASSED [  0%]
tests/integration/test_audit_triggers.py::TestAutomaticAuditTriggers::test_cascade_audit_on_reversal PASSED [  0%]
tests/integration/test_audit_triggers.py::TestAuditTriggerTransactionConsistency::test_audit_in_same_transaction PASSED [  0%]
tests/integration/test_audit_triggers.py::TestAuditTriggerTransactionConsistency::test_multiple_operations_in_transaction PASSED [  0%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_01_config_loading[Sanjay] PASSED [  0%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_02_statement_files_exist[Sanjay] PASSED [  0%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_03_category_classifier[Sanjay] PASSED [  0%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_04_intelligent_ingestion[Sanjay] PASSED [  1%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_05_data_validation[Sanjay] PASSED [  1%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_06_statistics_generation[Sanjay] PASSED [  1%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_07_fiscal_year_logic[Sanjay] PASSED [  1%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_08_income_extraction[Sanjay] PASSED [  1%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_09_excel_report_generation[Sanjay] PASSED [  1%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_10_category_distribution[Sanjay] PASSED [  1%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_11_deduplication[Sanjay] PASSED [  1%]
tests/integration/test_bank_intelligence/test_sanjay_integration.py::TestBankIntelligenceIntegration::test_12_pfas_asset_mapping[Sanjay] PASSED [  1%]
tests/integration/test_epf_integration.py::TestEPFParser::test_epf_parse_basic[Sanjay] PASSED [  1%]
tests/integration/test_epf_integration.py::TestEPFParser::test_epf_account_details[Sanjay] PASSED [  1%]
tests/integration/test_epf_integration.py::TestEPFParser::test_epf_transactions_structure[Sanjay] PASSED [  1%]
tests/integration/test_epf_integration.py::TestEPFParser::test_epf_save_to_db[Sanjay] FAILED [  2%]
tests/integration/test_epf_integration.py::TestEPFParser::test_epf_80c_calculation[Sanjay] PASSED [  2%]
tests/integration/test_epf_integration.py::TestEPFMultiUser::test_epf_multi_user_parse[Sanjay] PASSED [  2%]
tests/integration/test_epf_integration.py::TestEPFGoldenMaster::test_epf_totals_golden[Sanjay] PASSED [  2%]
tests/integration/test_mf_cams_integration.py::TestCAMSParser::test_cams_parse_basic[Sanjay] PASSED [  2%]
tests/integration/test_mf_cams_integration.py::TestCAMSParser::test_cams_capital_gains[Sanjay] PASSED [  2%]
tests/integration/test_mf_cams_integration.py::TestCAMSParser::test_cams_save_to_db[Sanjay] FAILED [  2%]
tests/integration/test_nps_integration.py::TestNPSParser::test_nps_parse_basic[Sanjay] FAILED [  2%]
tests/integration/test_nps_integration.py::TestNPSParser::test_nps_account_details[Sanjay] PASSED [  2%]
tests/integration/test_nps_integration.py::TestNPSParser::test_nps_tiers[Sanjay] PASSED [  2%]
tests/integration/test_nps_integration.py::TestNPSParser::test_nps_save_to_db[Sanjay] SKIPPED [  2%]
tests/integration/test_nps_integration.py::TestNPSParser::test_nps_deductions[Sanjay] PASSED [  2%]
tests/integration/test_ppf_integration.py::TestPPFParser::test_ppf_parse_basic[Sanjay] SKIPPED [  3%]
tests/integration/test_ppf_integration.py::TestPPFParser::test_ppf_account_details[Sanjay] PASSED [  3%]
tests/integration/test_ppf_integration.py::TestPPFParser::test_ppf_transaction_types[Sanjay] PASSED [  3%]
tests/integration/test_ppf_integration.py::TestPPFParser::test_ppf_save_to_db[Sanjay] SKIPPED [  3%]
tests/integration/test_ppf_integration.py::TestPPFParser::test_ppf_80c_calculation[Sanjay] PASSED [  3%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_01_data_folder_exists[Sanjay] PASSED [  3%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_02_parse_mf_cams[Sanjay] PASSED [  3%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_03_parse_mf_karvy[Sanjay] PASSED [  3%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_04_parse_zerodha_stocks[Sanjay] PASSED [  3%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_05_parse_icici_stocks[Sanjay] PASSED [  3%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_06_parse_nps[Sanjay] PASSED [  3%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_07_parse_ppf[Sanjay] PASSED [  3%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_08_parse_epf[Sanjay] PASSED [  4%]
tests/integration/test_sanjay_full_fy.py::TestMFCapitalGains::test_01_mf_capital_gains_calculation[Sanjay] PASSED [  4%]
tests/integration/test_sanjay_full_fy.py::TestStockCapitalGains::test_01_stock_capital_gains_zerodha[Sanjay] PASSED [  4%]
tests/integration/test_stock_integration.py::TestStockParser::test_stock_parse_basic[Sanjay] PASSED [  4%]
tests/integration/test_stock_integration.py::TestStockParser::test_stock_trade_types[Sanjay] PASSED [  4%]
tests/integration/test_stock_integration.py::TestStockParser::test_stock_save_to_db[Sanjay] SKIPPED [  4%]
tests/integration/test_stock_integration.py::TestStockParser::test_stock_capital_gains[Sanjay] PASSED [  4%]
tests/integration/test_full_fy.py::TestFullFY2425::test_01_load_bank_statements SKIPPED [  4%]
tests/integration/test_full_fy.py::TestFullFY2425::test_02_load_mf_statements SKIPPED [  4%]
tests/integration/test_full_fy.py::TestFullFY2425::test_03_load_salary_form16 SKIPPED [  4%]
tests/integration/test_full_fy.py::TestFullFY2425::test_04_verify_journal_balance SKIPPED [  4%]
tests/integration/test_full_fy.py::TestFullFY2425::test_05_tds_reconciliation SKIPPED [  4%]
tests/integration/test_full_fy.py::TestFullFY2425::test_06_generate_tax_computation SKIPPED [  5%]
tests/integration/test_full_fy.py::TestFullFY2425::test_07_itr2_json_export SKIPPED [  5%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_09_generate_balance_sheet PASSED [  5%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_10_generate_cash_flow_statement PASSED [  5%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_11_portfolio_valuation PASSED [  5%]
tests/integration/test_sanjay_full_fy.py::TestSanjayFullFY2425::test_12_verify_database_integrity PASSED [  5%]
tests/integration/test_thread_safety.py::TestConcurrentReads::test_concurrent_currency_reads PASSED [  5%]
tests/integration/test_thread_safety.py::TestConcurrentReads::test_concurrent_journal_reads PASSED [  5%]
tests/integration/test_thread_safety.py::TestConcurrentWrites::test_concurrent_currency_writes PASSED [  5%]
tests/integration/test_thread_safety.py::TestConcurrentWrites::test_concurrent_journal_writes PASSED [  5%]
tests/integration/test_thread_safety.py::TestTransactionIsolation::test_transaction_rollback_isolation PASSED [  5%]
tests/integration/test_thread_safety.py::TestTransactionIsolation::test_nested_transaction_handling PASSED [  5%]
tests/integration/test_thread_safety.py::TestWALMode::test_wal_mode_enabled PASSED [  5%]
tests/integration/test_thread_safety.py::TestWALMode::test_memory_db_no_wal PASSED [  6%]
tests/manual/test_icici_excel_real.py::test_icici_excel_parser PASSED    [  6%]
tests/manual/test_icici_real_data.py::test_icici_parser PASSED           [  6%]
tests/manual/test_icici_real_data.py::test_with_sbi_parser PASSED        [  6%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_00_verify_data_directories_exist PASSED [  6%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_01_mutual_fund_ingestion PASSED [  6%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_02_bank_statement_ingestion PASSED [  6%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_03_indian_stocks_ingestion PASSED [  6%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_04_salary_documents_ingestion PASSED [  6%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_05_epf_ingestion PASSED [  6%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_06_nps_ingestion PASSED [  6%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_07_ppf_ingestion PASSED [  6%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_08_sgb_ingestion PASSED [  7%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_09_usa_stocks_ingestion PASSED [  7%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_10_fd_bonds_ingestion PASSED [  7%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_90_database_integrity PASSED [  7%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_91_ingestion_log_integrity PASSED [  7%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_92_no_duplicate_records PASSED [  7%]
tests/regression/test_sanjay_regression.py::TestSanjayRegressionSuite::test_99_performance_metrics PASSED [  7%]
tests/regression/test_sanjay_regression.py::TestQuickSmokeTest::test_imports PASSED [  7%]
tests/regression/test_sanjay_regression.py::TestQuickSmokeTest::test_database_schema_creation PASSED [  7%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestCAMSNormalization::test_cams_holdings_normalization PASSED [  7%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestCAMSNormalization::test_cams_currency_cleaning PASSED [  7%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestKarvyNormalization::test_karvy_holdings_normalization PASSED [  7%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestKarvyNormalization::test_karvy_isin_extraction PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestDuplicatePrevention::test_duplicate_holdings_skipped PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestDuplicatePrevention::test_updated_holdings_updated PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestClassificationFallback::test_equity_classification PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestClassificationFallback::test_debt_classification PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestClassificationFallback::test_hybrid_classification PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestClassificationFallback::test_elss_classification PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestDecimalPrecision::test_units_precision PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestDecimalPrecision::test_currency_precision PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestDecimalPrecision::test_xirr_precision PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestRTADetection::test_cams_detection PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestRTADetection::test_karvy_detection PASSED [  8%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestRTADetection::test_unknown_rta PASSED [  9%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestDateExtraction::test_fy_date_extraction PASSED [  9%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestDateExtraction::test_iso_date_extraction PASSED [  9%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestDateExtraction::test_dmy_date_extraction PASSED [  9%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestDateExtraction::test_no_date PASSED [  9%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestStatementTypeDetection::test_capital_gains_detection PASSED [  9%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestStatementTypeDetection::test_holdings_detection PASSED [  9%]
tests/unit/test_analyzers/test_mf_analyzer.py::TestStatementTypeDetection::test_transactions_default PASSED [  9%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFFieldNormalizer::test_normalize_cams_holdings PASSED [  9%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFFieldNormalizer::test_normalize_karvy_holdings PASSED [  9%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFFieldNormalizer::test_currency_cleaning PASSED [  9%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFFieldNormalizer::test_date_parsing PASSED [  9%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFFieldNormalizer::test_decimal_precision PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestSchemeClassification::test_equity_classification PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestSchemeClassification::test_debt_classification PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestSchemeClassification::test_hybrid_classification PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestSchemeClassification::test_fallback_to_other PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestDuplicatePrevention::test_holdings_unique_constraint PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestDuplicatePrevention::test_different_nav_date_allowed PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFReconciler::test_reconciliation_within_tolerance PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFReconciler::test_reconciliation_outside_tolerance PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFReconciler::test_save_reconciliation_result FAILED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFFYAnalyzer::test_holdings_snapshot PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFFYAnalyzer::test_save_and_retrieve_snapshot PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestMFFYAnalyzer::test_yoy_growth_calculation PASSED [ 10%]
tests/unit/test_analyzers/test_mf_enhanced.py::TestFYDateUtilities::test_get_fy_dates PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestBrokerDetector::test_detect_from_folder_icicidirect PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestBrokerDetector::test_detect_from_folder_zerodha PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestBrokerDetector::test_detect_from_filename_keywords PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestBrokerDetector::test_detect_from_content_columns PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestBrokerDetector::test_detect_statement_type_holdings PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestBrokerDetector::test_detect_statement_type_transactions PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestBrokerDetector::test_detect_unknown_broker PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockFieldNormalizer::test_normalize_icici_holdings PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockFieldNormalizer::test_normalize_zerodha_holdings PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockFieldNormalizer::test_normalize_zerodha_transactions PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockFieldNormalizer::test_ltcg_classification PASSED [ 11%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockFieldNormalizer::test_currency_cleaning PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockFieldNormalizer::test_date_parsing PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockFieldNormalizer::test_quarter_determination PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockFieldNormalizer::test_fy_determination PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestXIRRCalculator::test_simple_profit_xirr PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestXIRRCalculator::test_simple_loss_xirr PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestXIRRCalculator::test_multiple_investments_xirr PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestXIRRCalculator::test_insufficient_data_xirr PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestXIRRCalculator::test_all_same_sign_xirr PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestXIRRCalculator::test_zero_profit_xirr PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockStatementScanner::test_scan_recursive PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockStatementScanner::test_skip_temp_files PASSED [ 12%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockStatementScanner::test_skip_duplicates PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestCapitalGainsRules::test_stcg_classification_under_365_days PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestCapitalGainsRules::test_ltcg_classification_over_365_days PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestCapitalGainsRules::test_ltcg_exactly_365_days PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestDataModels::test_normalized_holding_to_dict PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestDataModels::test_normalized_transaction_to_dict PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestDataModels::test_scanned_file_hash PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestStockAnalyzerIntegration::test_full_analysis_flow PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestEdgeCases::test_empty_dataframe_normalization PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestEdgeCases::test_missing_required_columns PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestEdgeCases::test_zero_quantity_filtered PASSED [ 13%]
tests/unit/test_analyzers/test_stock_analyzer.py::TestEdgeCases::test_nan_values_handling PASSED [ 13%]
tests/unit/test_core/test_accounts.py::TestChartOfAccountsSetup::test_chart_of_accounts_setup PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestChartOfAccountsSetup::test_hierarchy_setup PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestChartOfAccountsSetup::test_idempotent_setup PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestChartOfAccountsSetup::test_root_accounts_have_no_parent PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestChartOfAccountsSetup::test_account_types PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestChartOfAccountsSetup::test_foreign_asset_currency PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestAccountLookup::test_get_account_by_code PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestAccountLookup::test_get_account_by_code_not_found PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestAccountLookup::test_get_account_by_id PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestAccountLookup::test_get_accounts_by_type PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestAccountLookup::test_get_child_accounts PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestAccountLookup::test_get_child_accounts_not_found PASSED [ 14%]
tests/unit/test_core/test_accounts.py::TestAccountHierarchy::test_get_account_hierarchy_full PASSED [ 15%]
tests/unit/test_core/test_accounts.py::TestAccountHierarchy::test_get_account_hierarchy_subtree PASSED [ 15%]
tests/unit/test_core/test_accounts.py::TestAccountHierarchy::test_get_account_hierarchy_not_found PASSED [ 15%]
tests/unit/test_core/test_accounts.py::TestAccountDataclass::test_account_from_row PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_empty_asset_folder PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_flat_folder_structure PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_with_subfolders PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_mixed_structure PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_files_sorted_by_date PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_group_by_financial_year PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_duplicate_files_skipped PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_various_asset_types[Mutual-Fund] PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_various_asset_types[Indian-Stocks] PASSED [ 15%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_various_asset_types[USA-Stocks] PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_various_asset_types[PPF] PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_various_asset_types[NPS] PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_various_asset_types[Bank] PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_epf_asset PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_all_assets PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_with_archive PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_scan_specific_subfolders PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_move_to_failed PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestAssetScanner::test_failed_folder_excluded_from_scan PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestScannedAssetFile::test_file_hash_calculated PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestScannedAssetFile::test_financial_year_detected PASSED [ 16%]
tests/unit/test_core/test_asset_scanner.py::TestScannedAssetFile::test_is_transaction_property PASSED [ 17%]
tests/unit/test_core/test_asset_scanner.py::TestConvenienceFunction::test_scan_asset_inbox_function PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogCreation::test_audit_log_creation PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogCreation::test_log_insert PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogCreation::test_log_update PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogCreation::test_log_delete PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogCreation::test_invalid_action PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogCreation::test_user_id_override PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogCreation::test_default_user_id PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogRetrieval::test_get_log_entry PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogRetrieval::test_get_log_entry_not_found PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogRetrieval::test_get_record_history PASSED [ 17%]
tests/unit/test_core/test_audit.py::TestAuditLogRetrieval::test_get_table_history PASSED [ 18%]
tests/unit/test_core/test_audit.py::TestAuditLogRetrieval::test_get_table_history_with_limit PASSED [ 18%]
tests/unit/test_core/test_audit.py::TestAuditLogRetrieval::test_get_user_activity PASSED [ 18%]
tests/unit/test_core/test_audit.py::TestAuditLogRetrieval::test_get_user_activity_with_limit PASSED [ 18%]
tests/unit/test_core/test_audit.py::TestSensitiveDataMasking::test_mask_sensitive_values_pan PASSED [ 18%]
tests/unit/test_core/test_audit.py::TestSensitiveDataMasking::test_mask_sensitive_values_multiple PASSED [ 18%]
tests/unit/test_core/test_audit.py::TestSensitiveDataMasking::test_mask_sensitive_case_insensitive PASSED [ 18%]
tests/unit/test_core/test_audit.py::TestAuditLogEntryDataclass::test_from_row PASSED [ 18%]
tests/unit/test_core/test_currency.py::TestExchangeRateManagement::test_add_rate PASSED [ 18%]
tests/unit/test_core/test_currency.py::TestExchangeRateManagement::test_add_rate_with_source PASSED [ 18%]
tests/unit/test_core/test_currency.py::TestExchangeRateManagement::test_add_rate_upsert PASSED [ 18%]
tests/unit/test_core/test_currency.py::TestExchangeRateManagement::test_get_rate PASSED [ 18%]
tests/unit/test_core/test_currency.py::TestExchangeRateManagement::test_get_rate_not_found PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestExchangeRateManagement::test_get_rate_case_insensitive PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestCurrencyConversion::test_usd_to_inr_conversion PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestCurrencyConversion::test_convert_same_currency PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestCurrencyConversion::test_convert_with_rounding PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestCurrencyConversion::test_convert_rate_not_found PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestNearestRate::test_get_rate_or_nearest_exact PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestNearestRate::test_get_rate_or_nearest_fallback PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestNearestRate::test_get_rate_or_nearest_beyond_max_days PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestNearestRate::test_convert_uses_nearest_by_default PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestRatePeriod::test_get_rates_for_period PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestRatePeriod::test_get_rates_for_period_empty PASSED [ 19%]
tests/unit/test_core/test_currency.py::TestBulkRates::test_bulk_add_rates PASSED [ 20%]
tests/unit/test_core/test_currency.py::TestExchangeRateDataclass::test_from_row PASSED [ 20%]
tests/unit/test_core/test_currency.py::TestSbiRatePlaceholder::test_get_sbi_tt_buying_rate_placeholder PASSED [ 20%]
tests/unit/test_core/test_database.py::TestDatabaseManager::test_singleton_pattern PASSED [ 20%]
tests/unit/test_core/test_database.py::TestDatabaseManager::test_database_encryption_init PASSED [ 20%]
tests/unit/test_core/test_database.py::TestDatabaseManager::test_get_tables PASSED [ 20%]
tests/unit/test_core/test_database.py::TestDatabaseManager::test_connection_property_before_init PASSED [ 20%]
tests/unit/test_core/test_database.py::TestDatabaseManager::test_execute_and_commit PASSED [ 20%]
tests/unit/test_core/test_database.py::TestDatabaseManager::test_rollback PASSED [ 20%]
tests/unit/test_core/test_database.py::TestDatabaseManager::test_row_factory PASSED [ 20%]
tests/unit/test_core/test_database.py::TestDatabaseManager::test_foreign_keys_enabled PASSED [ 20%]
tests/unit/test_core/test_database.py::TestGetConnection::test_get_connection_after_init PASSED [ 20%]
tests/unit/test_core/test_database.py::TestGetConnection::test_get_connection_before_init PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_pan_encryption_roundtrip PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_aadhaar_encryption_roundtrip PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_bank_account_encryption_roundtrip PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_unique_salt_per_encryption PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_unique_ciphertext_per_encryption PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_wrong_master_key_fails PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_wrong_salt_fails PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_tampered_ciphertext_fails PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_ciphertext_structure PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_unicode_encryption PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestEncryption::test_empty_string_encryption PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestKeyDerivation::test_derive_key_length PASSED [ 21%]
tests/unit/test_core/test_encryption.py::TestKeyDerivation::test_derive_key_deterministic PASSED [ 22%]
tests/unit/test_core/test_encryption.py::TestKeyDerivation::test_derive_key_different_salt PASSED [ 22%]
tests/unit/test_core/test_encryption.py::TestKeyDerivation::test_generate_master_key PASSED [ 22%]
tests/unit/test_core/test_encryption.py::TestKeyDerivation::test_generate_master_key_with_salt PASSED [ 22%]
tests/unit/test_core/test_encryption.py::TestMaskSensitive::test_mask_pan PASSED [ 22%]
tests/unit/test_core/test_encryption.py::TestMaskSensitive::test_mask_aadhaar PASSED [ 22%]
tests/unit/test_core/test_encryption.py::TestMaskSensitive::test_mask_short_value PASSED [ 22%]
tests/unit/test_core/test_encryption.py::TestMaskSensitive::test_mask_custom_visible_chars PASSED [ 22%]
tests/unit/test_core/test_file_processor.py::TestFYDetection::test_detect_fy_from_filename[EPF_FY2024-25.pdf-2024-25] PASSED [ 22%]
tests/unit/test_core/test_file_processor.py::TestFYDetection::test_detect_fy_from_filename[EPF_FY24-25.pdf-2024-25] PASSED [ 22%]
tests/unit/test_core/test_file_processor.py::TestFYDetection::test_detect_fy_from_filename[Statement_2024-25.xlsx-2024-25] PASSED [ 22%]
tests/unit/test_core/test_file_processor.py::TestFYDetection::test_detect_fy_from_filename[NPS_2024-2025.csv-2024-25] PASSED [ 22%]
tests/unit/test_core/test_file_processor.py::TestFYDetection::test_detect_fy_from_filename[PPF_FY2425.pdf-2024-25] PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFYDetection::test_detect_fy_from_filename[Passbook_2024.pdf-2024-25] PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFYDetection::test_detect_fy_from_filename[EPF_Statement_FY_2023-24.pdf-2023-24] PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFYDetection::test_detect_fy_unknown PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFYFromDate::test_get_fy_from_date[txn_date0-2024-25] PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFYFromDate::test_get_fy_from_date[txn_date1-2024-25] PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFYFromDate::test_get_fy_from_date[txn_date2-2024-25] PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFYFromDate::test_get_fy_from_date[txn_date3-2024-25] PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFYFromDate::test_get_fy_from_date[txn_date4-2025-26] PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFileSorting::test_sort_by_fy_in_filename PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestFileSorting::test_sort_by_fy_reverse PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestGroupByFY::test_group_by_fy PASSED [ 23%]
tests/unit/test_core/test_file_processor.py::TestDeduplication::test_deduplicate_records PASSED [ 24%]
tests/unit/test_core/test_file_processor.py::TestGetLatestFile::test_get_latest_file PASSED [ 24%]
tests/unit/test_core/test_file_processor.py::TestGetLatestFile::test_get_latest_file_no_match PASSED [ 24%]
tests/unit/test_core/test_file_processor.py::TestGetLatestFile::test_get_latest_file_directory_not_exists PASSED [ 24%]
tests/unit/test_core/test_foundation_hardening.py::TestUserContext::test_set_and_get_current PASSED [ 24%]
tests/unit/test_core/test_foundation_hardening.py::TestUserContext::test_set_current_none_raises PASSED [ 24%]
tests/unit/test_core/test_foundation_hardening.py::TestUserContext::test_context_manager PASSED [ 24%]
tests/unit/test_core/test_foundation_hardening.py::TestRequireUserContext::test_decorator_with_user_id_kwarg PASSED [ 24%]
tests/unit/test_core/test_foundation_hardening.py::TestRequireUserContext::test_decorator_with_user_id_positional PASSED [ 24%]
tests/unit/test_core/test_foundation_hardening.py::TestRequireUserContext::test_decorator_raises_without_user_id PASSED [ 24%]
tests/unit/test_core/test_foundation_hardening.py::TestRequireUserContext::test_decorator_uses_global_context PASSED [ 24%]
tests/unit/test_core/test_foundation_hardening.py::TestRequireUserContext::test_decorator_validates_user_id_type PASSED [ 24%]
tests/unit/test_core/test_foundation_hardening.py::TestRequireUserContext::test_decorator_validates_positive_user_id PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestAuditLogger::test_log_insert PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestAuditLogger::test_log_update PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestAuditLogger::test_log_delete PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestAuditLogger::test_invalid_action_raises PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestNAVService::test_store_and_retrieve_nav PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestNAVService::test_nav_interpolation PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestNAVService::test_nav_fallback_to_nearest PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestNAVService::test_backfill_from_transactions PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestTransactionService::test_record_balanced_transaction PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestTransactionService::test_duplicate_detection PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestTransactionService::test_unbalanced_transaction_fails PASSED [ 25%]
tests/unit/test_core/test_foundation_hardening.py::TestTransactionService::test_get_transaction_by_key PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestIdempotencyKeyGenerator::test_mf_transaction_key PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestIdempotencyKeyGenerator::test_stock_trade_key PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestIdempotencyKeyGenerator::test_bank_transaction_key PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestIdempotencyMixin::test_mixin_generates_keys PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestIdempotencyMixin::test_mixin_deduplication PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestBatchIngester::test_file_hash_calculation PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestBatchIngester::test_duplicate_file_detection PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestBatchIngester::test_batch_result_tracking PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestStandaloneKeyFunctions::test_mf_key PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestStandaloneKeyFunctions::test_stock_key PASSED [ 26%]
tests/unit/test_core/test_foundation_hardening.py::TestStandaloneKeyFunctions::test_bank_key_hashes_account PASSED [ 26%]
tests/unit/test_core/test_journal.py::TestJournalBalanceValidation::test_journal_balance_validation PASSED [ 26%]
tests/unit/test_core/test_journal.py::TestJournalBalanceValidation::test_balance_with_tolerance PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestJournalBalanceValidation::test_balance_with_exchange_rate PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestJournalCreation::test_create_simple_journal PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestJournalCreation::test_create_multi_line_journal PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestJournalCreation::test_create_journal_validates_accounts PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestJournalRetrieval::test_get_journal PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestJournalRetrieval::test_get_journal_not_found PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestJournalReversal::test_reverse_journal PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestAccountBalance::test_get_account_balance PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestAccountBalance::test_balance_excludes_reversed PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestAccountLedger::test_get_account_ledger PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestJournalEntryDataclass::test_default_values PASSED [ 27%]
tests/unit/test_core/test_journal.py::TestJournalEntryDataclass::test_numeric_conversion PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestExtractionMetadata::test_default_values PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestExtractionMetadata::test_to_dict PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestExtractionMetadata::test_from_dict PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestStatementPeriod::test_to_dict PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestStatementPeriod::test_from_dict PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestStatementPeriod::test_from_none PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestManifestEntry::test_creation PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestManifestEntry::test_superseded_entry PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestManifestEntry::test_round_trip_serialization PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestCategoryManifest::test_init_empty PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestCategoryManifest::test_add_entry PASSED [ 28%]
tests/unit/test_core/test_manifest_and_uri.py::TestCategoryManifest::test_supersession PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestCategoryManifest::test_lineage_chain PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestCategoryManifest::test_point_in_time_query PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestCategoryManifest::test_needs_reextraction PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestPFASURIResolver::test_to_uri PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestPFASURIResolver::test_resolve PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestPFASURIResolver::test_round_trip PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestPFASURIResolver::test_parse_uri PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestPFASURIResolver::test_invalid_uri PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestPFASURIResolver::test_normalize_uri PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestPFASURIResolver::test_get_user_namespace PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestPFASURIResolver::test_uri_exists PASSED [ 29%]
tests/unit/test_core/test_manifest_and_uri.py::TestPFASURIResolver::test_list_user_namespaces PASSED [ 30%]
tests/unit/test_core/test_manifest_and_uri.py::TestCreateURI::test_basic_uri PASSED [ 30%]
tests/unit/test_core/test_manifest_and_uri.py::TestCreateURI::test_uri_with_category PASSED [ 30%]
tests/unit/test_core/test_manifest_and_uri.py::TestCreateURI::test_uri_with_filename PASSED [ 30%]
tests/unit/test_core/test_manifest_and_uri.py::TestCalculateFileHash::test_calculate_hash PASSED [ 30%]
tests/unit/test_core/test_manifest_and_uri.py::TestCalculateFileHash::test_same_content_same_hash PASSED [ 30%]
tests/unit/test_core/test_manifest_and_uri.py::TestCalculateFileHash::test_different_content_different_hash PASSED [ 30%]
tests/unit/test_core/test_manifest_and_uri.py::TestIntegration::test_archive_with_manifest_and_uri PASSED [ 30%]
tests/unit/test_core/test_session.py::TestSessionCreation::test_create_session PASSED [ 30%]
tests/unit/test_core/test_session.py::TestSessionCreation::test_create_session_with_custom_duration PASSED [ 30%]
tests/unit/test_core/test_session.py::TestSessionValidation::test_is_valid PASSED [ 30%]
tests/unit/test_core/test_session.py::TestSessionValidation::test_is_valid_invalid_token PASSED [ 30%]
tests/unit/test_core/test_session.py::TestSessionValidation::test_session_timeout PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionValidation::test_session_not_expired_within_timeout PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionValidation::test_session_max_duration_expiry PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionTouch::test_touch_updates_last_activity PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionTouch::test_touch_invalid_token PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionInvalidation::test_invalidate PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionInvalidation::test_invalidate_invalid_token PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionInvalidation::test_invalidate_all_user_sessions PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionRetrieval::test_get_session PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionRetrieval::test_get_session_not_found PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionRetrieval::test_get_user_sessions PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionRetrieval::test_get_user_sessions_active_only PASSED [ 31%]
tests/unit/test_core/test_session.py::TestSessionCleanup::test_cleanup_expired_sessions PASSED [ 31%]
tests/unit/test_core/test_session.py::TestRequireValidSession::test_require_valid_session_success PASSED [ 32%]
tests/unit/test_core/test_session.py::TestRequireValidSession::test_require_valid_session_expired PASSED [ 32%]
tests/unit/test_core/test_session.py::TestRequireValidSession::test_require_valid_session_invalid PASSED [ 32%]
tests/unit/test_core/test_session.py::TestSessionDataclass::test_is_expired_property PASSED [ 32%]
tests/unit/test_core/test_session.py::TestPasswordHashing::test_hash_password PASSED [ 32%]
tests/unit/test_core/test_session.py::TestPasswordHashing::test_hash_password_with_salt PASSED [ 32%]
tests/unit/test_core/test_session.py::TestPasswordHashing::test_verify_password_correct PASSED [ 32%]
tests/unit/test_core/test_session.py::TestPasswordHashing::test_verify_password_incorrect PASSED [ 32%]
tests/unit/test_core/test_session.py::TestPasswordHashing::test_different_passwords_different_hashes PASSED [ 32%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_transactions_folder PASSED [ 32%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_holdings_folder PASSED [ 32%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_nested_transactions_folder PASSED [ 32%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_filename_keywords[CAMS_txn_report.xlsx-StatementType.TRANSACTIONS] PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_filename_keywords[trade_history_2024.csv-StatementType.TRANSACTIONS] PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_filename_keywords[buy_sell_report.pdf-StatementType.TRANSACTIONS] PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_filename_keywords[capital_gains_FY2024.xlsx-StatementType.TRANSACTIONS] PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_filename_keywords[dividend_statement.pdf-StatementType.TRANSACTIONS] PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_filename_keywords[holding_summary.xlsx-StatementType.HOLDINGS] PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_filename_keywords[portfolio_valuation.pdf-StatementType.HOLDINGS] PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_filename_keywords[consolidated_statement.xlsx-StatementType.HOLDINGS] PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_filename_keywords[current_value_report.csv-StatementType.HOLDINGS] PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_filename_ambiguous_prefers_transactions PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_excel_content_transactions PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_detect_from_excel_content_holdings PASSED [ 33%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_file_override_in_config PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_custom_keywords_config PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_default_fallback_to_transactions PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_default_configurable PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_batch_detection PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_get_transactions_files PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementTypeDetection::test_get_holdings_files PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementRulesConfig::test_default_config_creation PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementRulesConfig::test_config_from_dict PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementRulesConfig::test_config_merge PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementRulesConfig::test_load_config_from_file PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestStatementRulesConfig::test_create_default_config_dict PASSED [ 34%]
tests/unit/test_core/test_statement_detector.py::TestDetectionPriority::test_folder_beats_filename PASSED [ 35%]
tests/unit/test_core/test_statement_detector.py::TestDetectionPriority::test_config_override_beats_all PASSED [ 35%]
tests/unit/test_core/test_statement_detector.py::TestDetectionPriority::test_filename_beats_content PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestRentalIncomeCalculator::test_let_out_property_calculation PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestRentalIncomeCalculator::test_self_occupied_property_calculation PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestRentalIncomeCalculator::test_loss_setoff_calculation PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestRentalIncomeManager::test_add_property PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestRentalIncomeManager::test_add_rental_income PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestRentalIncomeManager::test_hp_income_calculation PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestSGBParser::test_extract_maturity_date PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestSGBTracker::test_save_and_get_holding PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestSGBTracker::test_semi_annual_interest_calculation PASSED [ 35%]
tests/unit/test_parsers/test_assets/test_assets.py::TestSGBTracker::test_add_interest_from_bank PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestSGBTracker::test_maturity_cg_exempt PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestREITTracker::test_add_holding PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestREITTracker::test_distribution_types PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestREITTracker::test_cost_reduction PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestDividendTracker::test_add_dividend PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestDividendTracker::test_dividend_summary PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestDividendTracker::test_symbol_extraction PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestDividendTracker::test_symbol_summary PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestAssetIncomeSummary::test_total_taxable_income PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestAssetIncomeSummary::test_house_property_loss PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestAssetIncomeSummary::test_total_tds_credit PASSED [ 36%]
tests/unit/test_parsers/test_assets/test_assets.py::TestAssetIntegration::test_full_workflow PASSED [ 36%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_transaction_creation PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_transaction_with_numeric_amounts PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_auto_categorize_interest PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_auto_categorize_salary PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_auto_categorize_upi PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_auto_categorize_imps PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_auto_categorize_neft PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_auto_categorize_rtgs PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_auto_categorize_atm PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_auto_categorize_card PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_auto_categorize_other PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankTransaction::test_properties PASSED [ 37%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankAccount::test_account_creation PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankAccount::test_masked_number PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankAccount::test_masked_number_short PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_models.py::TestBankAccount::test_last4 PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_models.py::TestParseResult::test_successful_parse_result PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_models.py::TestParseResult::test_add_error_and_warning PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_models.py::TestParseResult::test_properties PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestICICIParser::test_parser_name PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestICICIParser::test_parse_amount PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestICICIParser::test_parse_amount_empty PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestICICIParser::test_parse_date PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestICICIParser::test_parse_date_invalid PASSED [ 38%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestSBIParser::test_parser_name PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestSBIParser::test_map_columns PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestSBIParser::test_map_columns_case_insensitive PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestSBIParser::test_map_columns_variants PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestHDFCParser::test_parser_name PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestHDFCParser::test_parse_amount PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestHDFCParser::test_parse_amount_empty PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_parsers_simple.py::TestHDFCParser::test_parse_date PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_utils.py::TestConsolidateTransactions::test_consolidate_single_result PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_utils.py::TestConsolidateTransactions::test_consolidate_multiple_results PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_utils.py::TestConsolidateTransactions::test_consolidate_removes_duplicates PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_utils.py::TestConsolidateTransactions::test_consolidate_sorts_by_date PASSED [ 39%]
tests/unit/test_parsers/test_bank/test_utils.py::TestConsolidateTransactions::test_consolidate_ignores_failed_results PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestConsolidateTransactions::test_consolidate_empty_results PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestConsolidateTransactions::test_consolidate_with_none_transactions PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestValidateTransactions::test_validate_valid_transactions PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestValidateTransactions::test_validate_missing_date PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestValidateTransactions::test_validate_empty_description PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestValidateTransactions::test_validate_both_debit_and_credit PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestValidateTransactions::test_validate_zero_amount PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestValidateTransactions::test_validate_multiple_issues PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestCalculateBalanceVerification::test_verify_correct_balances PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestCalculateBalanceVerification::test_verify_balance_mismatch PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestCalculateBalanceVerification::test_verify_empty_transactions PASSED [ 40%]
tests/unit/test_parsers/test_bank/test_utils.py::TestCalculateBalanceVerification::test_verify_transactions_without_balance PASSED [ 41%]
tests/unit/test_parsers/test_bank/test_utils.py::TestCalculateBalanceVerification::test_verify_allows_small_rounding_errors PASSED [ 41%]
tests/unit/test_parsers/test_bank/test_utils.py::TestCalculateBalanceVerification::test_verify_rejects_large_errors PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestSalaryValidation::test_valid_salary_components PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestSalaryValidation::test_invalid_salary_components_raises_error PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestSalaryValidation::test_salary_within_tolerance PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestSalaryValidation::test_salary_exceeds_tolerance PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestSalaryMultiLeg::test_salary_multi_leg_creates_correct_entries PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestSalaryMultiLeg::test_salary_multi_leg_validation_failure_prevents_entry PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestSalaryMultiLeg::test_employer_pf_contribution_entry PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestCostBasisTracker::test_fifo_cost_calculation PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestCostBasisTracker::test_insufficient_shares_raises_error PASSED [ 41%]
tests/unit/test_parsers/test_deep_accounting.py::TestCostBasisTracker::test_ltcg_determination_equity PASSED [ 42%]
tests/unit/test_parsers/test_deep_accounting.py::TestCostBasisTracker::test_stcg_determination PASSED [ 42%]
tests/unit/test_parsers/test_deep_accounting.py::TestCostBasisTracker::test_average_cost_calculation PASSED [ 42%]
tests/unit/test_parsers/test_deep_accounting.py::TestRSUAccounting::test_rsu_vest_creates_correct_entries PASSED [ 42%]
tests/unit/test_parsers/test_deep_accounting.py::TestRSUAccounting::test_rsu_vest_with_provided_tt_rate PASSED [ 42%]
tests/unit/test_parsers/test_deep_accounting.py::TestESPPAccounting::test_espp_purchase_with_discount_perquisite PASSED [ 42%]
tests/unit/test_parsers/test_deep_accounting.py::TestForeignDividendAccounting::test_foreign_dividend_with_withholding PASSED [ 42%]
tests/unit/test_parsers/test_deep_accounting.py::TestForexRateLookup::test_forex_rate_not_found_raises_error PASSED [ 42%]
tests/unit/test_parsers/test_deep_accounting.py::TestInventoryAccountingIntegration::test_mf_purchase_creates_lot PASSED [ 42%]
tests/unit/test_parsers/test_deep_accounting.py::TestInventoryAccountingIntegration::test_mf_redemption_uses_fifo_and_depletes_lots PASSED [ 42%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFParser::test_parser_initialization PASSED [ 42%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFParser::test_parse_nonexistent_file PASSED [ 42%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFParser::test_to_decimal_valid PASSED [ 42%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFParser::test_to_decimal_invalid PASSED [ 43%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFParser::test_calculate_80c_eligible PASSED [ 43%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFParser::test_get_or_create_account_new PASSED [ 43%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFParser::test_get_or_create_account_existing PASSED [ 43%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFModels::test_epf_account_creation PASSED [ 43%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFModels::test_epf_transaction_creation PASSED [ 43%]
tests/unit/test_parsers/test_epf/test_epf.py::TestEPFModels::test_epf_interest_creation PASSED [ 43%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestMorganStanleyParser::test_parser_initialization PASSED [ 43%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestMorganStanleyParser::test_parse_empty_content PASSED [ 43%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestActivityTypeMapping::test_vest_keywords PASSED [ 43%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestActivityTypeMapping::test_sale_keywords PASSED [ 43%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestActivityTypeMapping::test_dividend_keywords PASSED [ 43%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestActivityTypeMapping::test_dividend_reinvest_keywords PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestActivityTypeMapping::test_purchase_keywords PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestActivityTypeMapping::test_tax_withhold_keywords PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestActivityTypeMapping::test_fee_keywords PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestActivityTypeMapping::test_transfer_default PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDateParsing::test_parse_date_us_format PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDateParsing::test_parse_date_iso_format PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDateParsing::test_parse_date_short_year PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDateParsing::test_parse_date_text_format PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDateParsing::test_parse_date_invalid PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDecimalConversion::test_to_decimal_simple PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDecimalConversion::test_to_decimal_with_commas PASSED [ 44%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDecimalConversion::test_to_decimal_with_currency PASSED [ 45%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDecimalConversion::test_to_decimal_negative_parentheses PASSED [ 45%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestDecimalConversion::test_to_decimal_empty PASSED [ 45%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestCSVParsing::test_parse_csv_empty PASSED [ 45%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestCSVParsing::test_parse_csv_basic PASSED [ 45%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestCSVParsing::test_parse_csv_with_different_columns PASSED [ 45%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestParseResult::test_parse_result_fields PASSED [ 45%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestParseResult::test_parse_result_lists_empty PASSED [ 45%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestGrantType::test_grant_types PASSED [ 45%]
tests/unit/test_parsers/test_foreign/test_morgan_stanley.py::TestActivityType::test_activity_types PASSED [ 45%]
tests/unit/test_parsers/test_ledger_integration.py::TestAccountCode::test_bank_accounts PASSED [ 45%]
tests/unit/test_parsers/test_ledger_integration.py::TestAccountCode::test_investment_accounts PASSED [ 45%]
tests/unit/test_parsers/test_ledger_integration.py::TestAccountCode::test_retirement_accounts PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestAccountCode::test_capital_gains_accounts PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestHelperFunctions::test_generate_file_hash PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestHelperFunctions::test_map_bank_category_credit_salary PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestHelperFunctions::test_map_bank_category_credit_interest PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestHelperFunctions::test_map_bank_category_debit_investment PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestHelperFunctions::test_map_bank_category_debit_tax PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestMutualFundRecording::test_record_mf_purchase_success PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestMutualFundRecording::test_record_mf_purchase_duplicate PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestMutualFundRecording::test_record_mf_redemption_with_gain PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestMutualFundRecording::test_record_mf_redemption_with_loss PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestBankRecording::test_record_bank_credit PASSED [ 46%]
tests/unit/test_parsers/test_ledger_integration.py::TestBankRecording::test_record_bank_debit PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestStockRecording::test_record_stock_buy PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestStockRecording::test_record_stock_sell_with_gain PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestRetirementRecording::test_record_epf_contribution PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestRetirementRecording::test_record_epf_interest PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestRetirementRecording::test_record_ppf_deposit PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestRetirementRecording::test_record_ppf_interest PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestRetirementRecording::test_record_ppf_withdrawal PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestSalaryRecording::test_record_salary PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestIdempotencyKeys::test_mf_idempotency_key_format PASSED [ 47%]
tests/unit/test_parsers/test_ledger_integration.py::TestIdempotencyKeys::test_bank_idempotency_key_hashes_account PASSED [ 47%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_parser_initialization PASSED [ 47%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_extract_isin PASSED [ 47%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_determine_transaction_type_redemption PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_determine_transaction_type_purchase PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_determine_transaction_type_switch PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_determine_transaction_type_dividend PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_parse_date_valid PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_parse_date_invalid PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_to_decimal_valid PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_to_decimal_invalid PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_parse_nonexistent_file PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_parse_unsupported_format PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_parse_pdf_invalid_content PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_get_or_create_amc_new PASSED [ 48%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParser::test_get_or_create_amc_existing PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParserDatabaseOperations::test_save_to_db_empty_result PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_cams.py::TestCAMSParserDatabaseOperations::test_save_to_db_failed_result PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestCapitalGainsCalculator::test_equity_stcg_calculation PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestCapitalGainsCalculator::test_equity_ltcg_calculation PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestCapitalGainsCalculator::test_grandfathering_pre_31jan2018 PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestCapitalGainsCalculator::test_grandfathering_fmv_capped_at_sale_price PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestCapitalGainsCalculator::test_stt_deducted_from_gain PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestCapitalGainsCalculator::test_purchase_transaction_no_gain PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestCapitalGainsSummary::test_summary_creation PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestCapitalGainsSummary::test_equity_ltcg_exemption_applied PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestCapitalGainsSummary::test_equity_ltcg_below_exemption PASSED [ 49%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestTaxRates::test_equity_stcg_rate PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestTaxRates::test_equity_ltcg_rate PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestTaxRates::test_equity_ltcg_exemption PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_capital_gains.py::TestTaxRates::test_debt_taxed_at_slab PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestEquityClassification::test_bluechip_equity PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestEquityClassification::test_large_cap_equity PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestEquityClassification::test_mid_cap_equity PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestEquityClassification::test_small_cap_equity PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestEquityClassification::test_multi_cap_equity PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestEquityClassification::test_flexi_cap_equity PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestEquityClassification::test_index_equity PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestEquityClassification::test_sectoral_equity PASSED [ 50%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestEquityClassification::test_elss_equity PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestDebtClassification::test_liquid_debt PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestDebtClassification::test_corporate_bond_debt PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestDebtClassification::test_short_duration_debt PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestDebtClassification::test_gilt_debt PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestDebtClassification::test_dynamic_bond_debt PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestDebtClassification::test_money_market_debt PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestHybridClassification::test_balanced_hybrid PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestHybridClassification::test_aggressive_hybrid PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestHybridClassification::test_conservative_hybrid PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestHybridClassification::test_equity_savings_hybrid PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestHybridClassification::test_arbitrage_hybrid PASSED [ 51%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestOtherClassification::test_unknown_scheme PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestOtherClassification::test_empty_scheme PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestHoldingPeriodThreshold::test_equity_threshold PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestHoldingPeriodThreshold::test_debt_threshold PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestHoldingPeriodThreshold::test_hybrid_threshold PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestHoldingPeriodThreshold::test_other_threshold PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestELSSDetection::test_elss_keyword PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestELSSDetection::test_tax_saver_keyword PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestELSSDetection::test_not_elss PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_classifier.py::TestELSSDetection::test_case_insensitive PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_parser_initialization PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_extract_isin_parenthetical_format PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_extract_isin_cams_format PASSED [ 52%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_extract_isin_none PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_determine_transaction_type_redemption PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_determine_transaction_type_purchase PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_determine_transaction_type_switch PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_determine_transaction_type_dividend PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_determine_transaction_type_empty PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_parse_date_valid_formats PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_parse_date_invalid PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_to_decimal_valid PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_to_decimal_invalid PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_parse_nonexistent_file PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_parse_unsupported_format PASSED [ 53%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_parse_pdf_invalid_content PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_get_or_create_amc_new PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_get_or_create_amc_existing PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParser::test_duplicate_count_tracking PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParserDatabaseOperations::test_save_to_db_empty_result PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParserDatabaseOperations::test_save_to_db_failed_result PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParserDatabaseOperations::test_get_column_value_variations PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParserValidation::test_validate_karvy_dataframe_valid PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParserValidation::test_validate_karvy_dataframe_missing_columns PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParserValidation::test_validate_karvy_dataframe_empty PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_karvy.py::TestKarvyParserValidation::test_validate_karvy_dataframe_case_insensitive PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_models.py::TestAssetClass::test_asset_class_values PASSED [ 54%]
tests/unit/test_parsers/test_mf/test_models.py::TestTransactionType::test_transaction_type_values PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFScheme::test_scheme_creation PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFScheme::test_scheme_auto_classification PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFTransaction::test_purchase_transaction PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFTransaction::test_holding_period_days_redemption PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFTransaction::test_holding_period_days_purchase PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFTransaction::test_is_long_term_equity_short PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFTransaction::test_is_long_term_equity_long PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFTransaction::test_is_long_term_debt PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFTransaction::test_is_grandfathered_true PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestMFTransaction::test_is_grandfathered_false_after_date PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestParseResult::test_successful_result PASSED [ 55%]
tests/unit/test_parsers/test_mf/test_models.py::TestParseResult::test_add_error PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_models.py::TestParseResult::test_add_warning PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestTransactionTypeClassification::test_purchase_sip PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestTransactionTypeClassification::test_purchase PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestTransactionTypeClassification::test_redemption PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestTransactionTypeClassification::test_switch_in PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestTransactionTypeClassification::test_switch_out PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestTransactionTypeClassification::test_dividend_reinvest PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestTransactionTypeClassification::test_stt_tax PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestTransactionTypeClassification::test_stamp_duty PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestExceptionHierarchy::test_base_exception PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestExceptionHierarchy::test_cas_parse_error PASSED [ 56%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestExceptionHierarchy::test_incorrect_password_error PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestExceptionHierarchy::test_balance_mismatch_error PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestExceptionHierarchy::test_fifo_mismatch_error PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestFIFOUnitTracker::test_add_purchase PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestFIFOUnitTracker::test_simple_redemption PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestFIFOUnitTracker::test_fifo_order PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestFIFOUnitTracker::test_partial_lot_matching PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestFIFOUnitTracker::test_stcg_classification PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestPortfolioFIFOTracker::test_multiple_schemes PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestCASModels::test_cas_file_type_enum PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestCASModels::test_cas_source_enum PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestCASModels::test_statement_period PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestCASModels::test_cas_scheme_balance_mismatch PASSED [ 57%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestCASModels::test_cas_data_totals PASSED [ 58%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestCASPDFParserHelpers::test_is_transaction_line PASSED [ 58%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestCASPDFParserHelpers::test_is_scheme_line PASSED [ 58%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestCASPDFParserHelpers::test_parse_decimal PASSED [ 58%]
tests/unit/test_parsers/test_mf/test_phase1_fixes.py::TestCASPDFParserHelpers::test_parse_date PASSED [ 58%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSParser::test_parser_initialization PASSED [ 58%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSParser::test_parse_nonexistent_file PASSED [ 58%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSParser::test_get_financial_year PASSED [ 58%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSParser::test_to_decimal_valid PASSED [ 58%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSParser::test_to_decimal_invalid PASSED [ 58%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSParser::test_calculate_deductions_below_limits PASSED [ 58%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSParser::test_calculate_deductions_above_limits PASSED [ 58%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSParser::test_get_or_create_account PASSED [ 59%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSModels::test_nps_account_creation PASSED [ 59%]
tests/unit/test_parsers/test_nps/test_nps.py::TestNPSModels::test_nps_transaction_creation PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFParser::test_parser_initialization PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFParser::test_parse_nonexistent_file PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFParser::test_get_financial_year PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFParser::test_to_decimal_valid PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFParser::test_to_decimal_invalid PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFParser::test_calculate_80c_eligible_below_limit PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFParser::test_calculate_80c_eligible_above_limit PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFParser::test_get_or_create_account PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFModels::test_ppf_account_creation PASSED [ 59%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFModels::test_ppf_account_maturity_calculation PASSED [ 60%]
tests/unit/test_parsers/test_ppf/test_ppf.py::TestPPFModels::test_ppf_transaction_creation PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16Parser::test_parser_initialization PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16Parser::test_parser_initialization_no_db PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16Parser::test_parse_nonexistent_file PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16ParserDecimalConversion::test_to_decimal_valid PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16ParserDecimalConversion::test_to_decimal_invalid PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16Record::test_form16_record_creation PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16Record::test_form16_record_defaults PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16Record::test_calculate_total_tds PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16Record::test_calculate_gross_salary PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16PartA::test_quarterly_tds_structure PASSED [ 60%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16PartB::test_section_17_components PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16PartB::test_standard_deduction PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16PartB::test_chapter_via_deductions PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_form16.py::TestForm16PartB::test_employer_nps_80ccd2 PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRACalculator::test_calculator_creation PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRACalculator::test_metro_percentage PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRACalculator::test_non_metro_percentage PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRACalculation::test_exemption_limited_by_actual_hra PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRACalculation::test_exemption_limited_by_rent_minus_10_percent PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRACalculation::test_exemption_limited_by_percentage_of_basic_metro PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRACalculation::test_exemption_limited_by_percentage_of_basic_non_metro PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRACalculation::test_zero_rent_paid PASSED [ 61%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRACalculation::test_taxable_hra_calculation PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRAMonthlyCalculation::test_calculate_monthly PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestHRAAnnualFromMonthly::test_calculate_annual_from_monthly PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestMetroCityDetection::test_is_metro_city_delhi PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestMetroCityDetection::test_is_metro_city_mumbai PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestMetroCityDetection::test_is_metro_city_chennai PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestMetroCityDetection::test_is_metro_city_kolkata PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestMetroCityDetection::test_is_metro_city_bangalore PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestMetroCityDetection::test_is_metro_city_hyderabad PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestMetroCityDetection::test_is_non_metro_city PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestMetroCityDetection::test_is_metro_city_empty PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_hra.py::TestNewRegimeHRA::test_new_regime_no_exemption PASSED [ 62%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestPayslipParser::test_parser_initialization PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestPayslipParser::test_parser_initialization_no_db PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestPayslipParser::test_parse_nonexistent_file PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestPayslipParser::test_parse_unsupported_format PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestPayslipParserDecimalConversion::test_to_decimal_valid PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestPayslipParserDecimalConversion::test_to_decimal_negative PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestPayslipParserDecimalConversion::test_to_decimal_invalid PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestPayslipParserPatterns::test_patterns_exist PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestSalaryRecord::test_salary_record_creation PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestSalaryRecord::test_salary_record_defaults PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestSalaryRecord::test_calculate_totals PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestRSUTaxCreditHandling::test_rsu_tax_credit_negative_is_credit PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestRSUTaxCreditHandling::test_rsu_tax_credit_not_in_deductions PASSED [ 63%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestRSUTaxCreditHandling::test_rsu_credit_status_pending PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestESPPHandling::test_espp_deduction_tracking PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestESPPHandling::test_tcs_on_espp_tracking PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestProfessionalTaxHandling::test_professional_tax_tracking PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestProfessionalTaxHandling::test_professional_tax_annual_limit PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestAnnualSalarySummary::test_annual_summary_creation PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_payslip.py::TestAnnualSalarySummary::test_annual_summary_aggregation PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestRSUTaxCreditCorrelator::test_correlator_initialization PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestRSUTaxCreditCorrelator::test_tax_rate_constants PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestRSUTaxCreditModel::test_credit_creation PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestRSUTaxCreditModel::test_credit_default_status PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestRSUTaxCreditModel::test_credit_no_vest_link PASSED [ 64%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestCorrelationStatus::test_pending_status PASSED [ 65%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestCorrelationStatus::test_matched_status PASSED [ 65%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestCorrelationStatus::test_unmatched_status PASSED [ 65%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestCorrelationLogic::test_expected_perquisite_range PASSED [ 65%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestCorrelationLogic::test_tax_credit_is_percentage_of_perquisite PASSED [ 65%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestGetUnmatchedCredits::test_get_unmatched_empty PASSED [ 65%]
tests/unit/test_parsers/test_salary/test_rsu_correlation.py::TestAnnualRSUSummary::test_summary_no_credits PASSED [ 65%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_parser_initialization PASSED [ 65%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_parse_nonexistent_file PASSED [ 65%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_parse_unsupported_format PASSED [ 65%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_parse_date_icici_format PASSED [ 65%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_parse_date_iso_format PASSED [ 65%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_parse_date_object PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_parse_date_invalid PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_to_decimal_valid PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_to_decimal_with_commas PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_to_decimal_invalid PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_get_or_create_broker_new PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_get_or_create_broker_existing PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParser::test_section_markers PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParserCapitalGains::test_calculate_capital_gains_empty PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParserCapitalGains::test_calculate_capital_gains_stcg_only PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParserCapitalGains::test_calculate_capital_gains_ltcg_only PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParserCapitalGains::test_calculate_capital_gains_ltcg_below_exemption PASSED [ 66%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParserDatabaseOperations::test_save_to_db_empty_result PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParserDatabaseOperations::test_save_to_db_failed_result PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParserCSVParsing::test_parse_valid_csv PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParserCSVParsing::test_parse_csv_with_ltcg_section PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_icici.py::TestICICIDirectParserCSVParsing::test_parse_empty_csv PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_models.py::TestStockTrade::test_trade_creation PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_models.py::TestStockTrade::test_net_amount_calculation_buy PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_models.py::TestStockTrade::test_net_amount_calculation_sell PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_models.py::TestStockTrade::test_holding_period_calculation PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_models.py::TestStockTrade::test_is_ltcg_true PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_models.py::TestStockTrade::test_is_ltcg_false PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_models.py::TestStockTrade::test_intraday_trade PASSED [ 67%]
tests/unit/test_parsers/test_stock/test_models.py::TestCapitalGainsSummary::test_taxable_amounts_calculation PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_models.py::TestCapitalGainsSummary::test_ltcg_below_exemption PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_models.py::TestCapitalGainsSummary::test_tax_calculation PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_models.py::TestParseResult::test_parse_result_success PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_models.py::TestParseResult::test_add_error PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_models.py::TestParseResult::test_add_warning PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParser::test_parser_initialization PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParser::test_parse_nonexistent_file PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParser::test_parse_date_valid PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParser::test_parse_date_invalid PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParser::test_to_decimal_valid PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParser::test_to_decimal_invalid PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParser::test_get_or_create_broker_new PASSED [ 68%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParser::test_get_or_create_broker_existing PASSED [ 69%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParserDatabaseOperations::test_save_to_db_empty_result PASSED [ 69%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParserDatabaseOperations::test_save_to_db_failed_result PASSED [ 69%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParserDividends::test_dividend_summary_empty PASSED [ 69%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParserDividends::test_dividend_summary_with_dividends PASSED [ 69%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParserDividends::test_save_dividends_empty PASSED [ 69%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParserSTT::test_stt_summary_empty PASSED [ 69%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParserSTT::test_stt_summary_with_entries PASSED [ 69%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParserSTT::test_save_stt_empty PASSED [ 69%]
tests/unit/test_parsers/test_stock/test_zerodha.py::TestZerodhaParserSaveAll::test_save_all_empty PASSED [ 69%]
tests/unit/test_parsers/test_validators.py::TestExcelValidator::test_valid_file PASSED [ 69%]
tests/unit/test_parsers/test_validators.py::TestExcelValidator::test_file_not_found PASSED [ 69%]
tests/unit/test_parsers/test_validators.py::TestExcelValidator::test_min_rows_check PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestExcelValidator::test_required_columns PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestExcelValidator::test_missing_columns PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestExcelValidator::test_is_valid_helper PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestCSVValidator::test_valid_file PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestCSVValidator::test_empty_file PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestCSVValidator::test_required_columns PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestCSVValidator::test_missing_columns PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestCompositeValidator::test_validates_xlsx PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestCompositeValidator::test_validates_csv PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestCompositeValidator::test_unsupported_extension PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestNPSValidator::test_valid_nps_file PASSED [ 70%]
tests/unit/test_parsers/test_validators.py::TestNPSValidator::test_missing_nps_columns PASSED [ 71%]
tests/unit/test_parsers/test_validators.py::TestPPFValidator::test_valid_ppf_file PASSED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archiver_init PASSED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_single_file FAILED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_preserves_structure FAILED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_naming_convention FAILED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_handles_duplicate_names FAILED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_nonexistent_file PASSED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_multiple_files PASSED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_detects_source_from_path FAILED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_unique_path_generation PASSED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestArchiveResult::test_default_success PASSED [ 71%]
tests/unit/test_phase1/test_archiver.py::TestArchiveResult::test_success_with_failures PASSED [ 72%]
tests/unit/test_phase1/test_archiver.py::test_convenience_function PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestMFIngester::test_ingester_init PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestMFIngester::test_ingest_empty_inbox PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestMFIngester::test_is_already_processed PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestMFIngester::test_create_ingestion_log PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestMFIngester::test_update_ingestion_status PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestMFIngester::test_get_ingestion_history PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestMFIngester::test_get_pending_files PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestIngestionResult::test_default_success PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestIngestionResult::test_add_error_sets_failure PASSED [ 72%]
tests/unit/test_phase1/test_mf_ingester.py::TestIngestionResult::test_add_warning_keeps_success PASSED [ 72%]
tests/unit/test_phase1/test_mf_scanner.py::TestMFStatementScanner::test_scan_empty_inbox PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestMFStatementScanner::test_scan_detects_rta_from_path PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestMFStatementScanner::test_scan_detects_file_types PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestMFStatementScanner::test_scan_calculates_file_hash PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestMFStatementScanner::test_scan_nonexistent_path PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestMFStatementScanner::test_scan_recursive_subfolders PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestMFStatementScanner::test_scan_ignores_unsupported_files PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestScannedFile::test_file_hash_calculation PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestScannedFile::test_same_content_same_hash PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestScanResult::test_success_with_no_errors PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::TestScanResult::test_cams_files_filter PASSED [ 73%]
tests/unit/test_phase1/test_mf_scanner.py::test_convenience_function PASSED [ 73%]
tests/unit/test_phase1/test_parser_fragility.py::TestEmptyFileHandling::test_epf_nonexistent_file PASSED [ 73%]
tests/unit/test_phase1/test_parser_fragility.py::TestEmptyFileHandling::test_nps_empty_csv PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestEmptyFileHandling::test_nps_csv_headers_only PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestEmptyFileHandling::test_ppf_empty_excel PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestMissingColumns::test_nps_missing_pran_column PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestMissingColumns::test_ppf_missing_date_column PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestMalformedData::test_nps_invalid_date_format PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestMalformedData::test_ppf_negative_amounts PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestFYDetection::test_fy_pattern_fy2425 PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestFYDetection::test_fy_pattern_20242025 PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestFYDetection::test_fy_extraction_utility PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestMultiFileHandling::test_file_sorting_by_date PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestMultiFileHandling::test_exclude_failed_directory PASSED [ 74%]
tests/unit/test_phase1/test_parser_fragility.py::TestIngesterValidation::test_ingester_empty_transactions_should_fail PASSED [ 75%]
tests/unit/test_phase1/test_parser_fragility.py::TestIngesterValidation::test_ingester_respects_parse_result_errors PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPathResolverInitialization::test_basic_initialization PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPathResolverInitialization::test_whitespace_in_username_trimmed PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPathResolverInitialization::test_config_loading PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPathResolverInitialization::test_fallback_defaults_when_no_config PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPathGeneration::test_inbox_path PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPathGeneration::test_archive_path PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPathGeneration::test_reports_path PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPathGeneration::test_db_path PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPathGeneration::test_report_file_generation PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPasswordHandling::test_exact_filename_match PASSED [ 75%]
tests/unit/test_phase1/test_path_resolver.py::TestPasswordHandling::test_pattern_match PASSED [ 76%]
tests/unit/test_phase1/test_path_resolver.py::TestPasswordHandling::test_substring_pattern_match PASSED [ 76%]
tests/unit/test_phase1/test_path_resolver.py::TestPasswordHandling::test_wildcard_fallback PASSED [ 76%]
tests/unit/test_phase1/test_path_resolver.py::TestPasswordHandling::test_no_password_file PASSED [ 76%]
tests/unit/test_phase1/test_path_resolver.py::TestMultiUserIsolation::test_different_users_different_paths PASSED [ 76%]
tests/unit/test_phase1/test_path_resolver.py::TestMultiUserIsolation::test_paths_contain_username PASSED [ 76%]
tests/unit/test_phase1/test_path_resolver.py::TestEdgeCases::test_path_with_spaces PASSED [ 76%]
tests/unit/test_phase1/test_path_resolver.py::TestEdgeCases::test_unicode_username PASSED [ 76%]
tests/unit/test_phase1/test_path_resolver.py::TestEdgeCases::test_root_as_string PASSED [ 76%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_reconciler_init PASSED [ 76%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_reconciler_custom_threshold PASSED [ 76%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_reconcile_matching_holdings PASSED [ 76%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_reconcile_detects_unit_mismatch PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_reconcile_detects_value_mismatch PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_reconcile_ignores_small_differences PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_reconcile_missing_in_db PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_log_mismatches_to_db PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_get_unresolved_mismatches PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestReconciler::test_resolve_mismatch PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestMismatch::test_mismatch_to_dict PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestReconciliationResult::test_mismatch_count PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestReconciliationResult::test_match_rate_calculation PASSED [ 77%]
tests/unit/test_phase1/test_reconciler.py::TestReconciliationResult::test_match_rate_zero_records PASSED [ 77%]
tests/unit/test_phase1/test_reports.py::TestReportConfig::test_filename_generation PASSED [ 77%]
tests/unit/test_phase1/test_reports.py::TestReportConfig::test_path_generation PASSED [ 78%]
tests/unit/test_phase1/test_reports.py::TestMFIngestionReportGenerator::test_generator_init PASSED [ 78%]
tests/unit/test_phase1/test_reports.py::TestMFIngestionReportGenerator::test_generate_transactions_report PASSED [ 78%]
tests/unit/test_phase1/test_reports.py::TestMFIngestionReportGenerator::test_generate_holdings_report PASSED [ 78%]
tests/unit/test_phase1/test_reports.py::TestMFIngestionReportGenerator::test_generate_ingestion_report PASSED [ 78%]
tests/unit/test_phase1/test_reports.py::TestMFIngestionReportGenerator::test_generate_all_reports PASSED [ 78%]
tests/unit/test_phase1/test_reports.py::TestMFIngestionReportGenerator::test_report_naming_convention PASSED [ 78%]
tests/unit/test_phase1/test_reports.py::test_convenience_function PASSED [ 78%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestQuarterlySummary::test_total_stcg_calculation PASSED [ 78%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestQuarterlySummary::test_total_ltcg_calculation PASSED [ 78%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestQuarterlySummary::test_empty_quarter PASSED [ 78%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestFYSummary::test_total_stcg PASSED [ 78%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestFYSummary::test_total_ltcg PASSED [ 78%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestFYSummary::test_default_tax_rates PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReport::test_initialization PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReport::test_ltcg_exemption_constant PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReport::test_quarters_definition PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReport::test_generate_empty_data PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReport::test_quarter_date_ranges_fy_2024_25 PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportWithData::test_generate_with_equity_stcg PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportWithData::test_generate_with_equity_ltcg PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportWithData::test_generate_with_debt_transaction PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportWithData::test_ltcg_exemption_applied PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportWithData::test_ltcg_below_exemption PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportWithData::test_multiple_quarters PASSED [ 79%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportExcel::test_export_excel_creates_file PASSED [ 80%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportExcel::test_export_excel_has_sheets PASSED [ 80%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportExcel::test_export_excel_summary_content PASSED [ 80%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportPDF::test_export_pdf_with_reportlab PASSED [ 80%]
tests/unit/test_reports/test_mf_capital_gains_report.py::TestMFCapitalGainsReportPDF::test_export_pdf_returns_none_without_reportlab PASSED [ 80%]
tests/unit/test_reports/test_networth_report.py::TestXIRRCalculator::test_xirr_simple_case PASSED [ 80%]
tests/unit/test_reports/test_networth_report.py::TestXIRRCalculator::test_xirr_multiple_cashflows PASSED [ 80%]
tests/unit/test_reports/test_networth_report.py::TestXIRRCalculator::test_xirr_negative_return PASSED [ 80%]
tests/unit/test_reports/test_networth_report.py::TestXIRRCalculator::test_xirr_insufficient_data PASSED [ 80%]
tests/unit/test_reports/test_networth_report.py::TestXIRRCalculator::test_xirr_all_positive PASSED [ 80%]
tests/unit/test_reports/test_networth_report.py::TestXIRRCalculator::test_xirr_all_negative PASSED [ 80%]
tests/unit/test_reports/test_networth_report.py::TestXIRRCalculator::test_xirr_zero_investment PASSED [ 80%]
tests/unit/test_reports/test_networth_report.py::TestXIRRCalculator::test_xirr_high_return PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestXIRRCalculator::test_xirr_sip_pattern PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_parse_fy_range_current PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_parse_fy_range_single_fy PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_parse_fy_range_multi_year PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_generate_periods_fy PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_generate_periods_quarterly PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_generate_periods_monthly PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_calculate_with_mf_data PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_calculate_with_stock_data PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_calculate_with_epf_balance PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_calculate_empty_data PASSED [ 81%]
tests/unit/test_reports/test_networth_report.py::TestNetworthCalculator::test_allocation_percentage PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestNetworthReportGenerator::test_generate_creates_file PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestNetworthReportGenerator::test_generate_with_data PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestNetworthReportGenerator::test_generate_all_sheets PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestDataModels::test_asset_holding_gain_calculation PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestDataModels::test_asset_holding_with_forex PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestDataModels::test_period_snapshot_totals PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestDataModels::test_period_snapshot_zero_cost PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestIntegration::test_full_networth_calculation PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestIntegration::test_yoy_growth_calculation PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestIntegration::test_cagr_calculation PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestIntegration::test_full_report_generation PASSED [ 82%]
tests/unit/test_reports/test_networth_report.py::TestIntegration::test_quarterly_breakdown PASSED [ 83%]
tests/unit/test_reports/test_networth_report.py::TestEdgeCases::test_missing_table PASSED [ 83%]
tests/unit/test_reports/test_networth_report.py::TestEdgeCases::test_null_values PASSED [ 83%]
tests/unit/test_reports/test_networth_report.py::TestEdgeCases::test_future_date_range PASSED [ 83%]
tests/unit/test_reports/test_networth_report.py::TestEdgeCases::test_invalid_user PASSED [ 83%]
tests/unit/test_reports/test_stock_holdings_report.py::TestHoldingsReportData::test_calculate_totals PASSED [ 83%]
tests/unit/test_reports/test_stock_holdings_report.py::TestHoldingsReportData::test_empty_holdings PASSED [ 83%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReport::test_initialization PASSED [ 83%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReport::test_generate_empty PASSED [ 83%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReportFromTrades::test_single_buy PASSED [ 83%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReportFromTrades::test_multiple_buys_same_stock PASSED [ 83%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReportFromTrades::test_buy_and_partial_sell_fifo PASSED [ 83%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReportFromTrades::test_complete_sell PASSED [ 84%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReportFromTrades::test_multiple_stocks PASSED [ 84%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReportFromTrades::test_as_of_date_filter PASSED [ 84%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReportFromTrades::test_intraday_trades_excluded PASSED [ 84%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReportExcel::test_export_excel_creates_file PASSED [ 84%]
tests/unit/test_reports/test_stock_holdings_report.py::TestStockHoldingsReportExcel::test_export_excel_empty_holdings PASSED [ 84%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestSBITTRateProvider::test_provider_initialization PASSED [ 84%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestSBITTRateProvider::test_max_lookback_constant PASSED [ 84%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestAddRate::test_add_rate PASSED [ 84%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestAddRate::test_add_manual_rate PASSED [ 84%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestAddRate::test_add_rate_replaces_existing PASSED [ 84%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetRate::test_get_exact_rate PASSED [ 84%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetRate::test_get_nearest_rate PASSED [ 84%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetRate::test_get_rate_no_rate_available PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetRate::test_get_rate_different_currency PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetRateRecord::test_get_rate_record PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetRateRecord::test_get_rate_record_none PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestBulkAddRates::test_bulk_add_rates PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetRatesForPeriod::test_get_rates_for_period PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetRatesForPeriod::test_get_rates_empty_period PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetFYEndRate::test_get_fy_end_rate PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestGetFYEndRate::test_get_fy_end_rate_nearest PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestConvert::test_convert PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestConvert::test_convert_with_decimals PASSED [ 85%]
tests/unit/test_services/test_currency/test_rate_provider.py::TestExchangeRateModel::test_exchange_rate_creation PASSED [ 85%]
tests/unit/test_services/test_encrypted_file_handler.py::TestPathResolverPasswordMethods::test_password_config_file_path PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestPathResolverPasswordMethods::test_get_file_password_exact_match PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestPathResolverPasswordMethods::test_get_file_password_pattern_match PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestPathResolverPasswordMethods::test_get_file_password_wildcard_fallback PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestPathResolverPasswordMethods::test_get_file_password_priority_order PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestPathResolverPasswordMethods::test_get_file_password_no_config PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestPathResolverPasswordMethods::test_get_file_password_interactive PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestEncryptedFileHandler::test_initialization PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestEncryptedFileHandler::test_get_password_from_config PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestEncryptedFileHandler::test_get_password_caching PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestEncryptedFileHandler::test_get_password_no_caching PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestEncryptedFileHandler::test_clear_cache_specific_file PASSED [ 86%]
tests/unit/test_services/test_encrypted_file_handler.py::TestEncryptedFileHandler::test_clear_cache_all PASSED [ 87%]
tests/unit/test_services/test_encrypted_file_handler.py::TestEncryptedFileHandler::test_non_interactive_mode PASSED [ 87%]
tests/unit/test_services/test_encrypted_file_handler.py::TestEncryptedFileHandlerPDFIntegration::test_open_pdf_pdfplumber_success SKIPPED [ 87%]
tests/unit/test_services/test_encrypted_file_handler.py::TestEncryptedFileHandlerPDFIntegration::test_open_pdf_pypdf2_success SKIPPED [ 87%]
tests/unit/test_services/test_encrypted_file_handler.py::TestFactoryFunction::test_create_encrypted_file_handler PASSED [ 87%]
tests/unit/test_services/test_encrypted_file_handler.py::TestFactoryFunction::test_create_encrypted_file_handler_non_interactive PASSED [ 87%]
tests/unit/test_services/test_financial_statements.py::TestCoreModels::test_get_financial_year_april PASSED [ 87%]
tests/unit/test_services/test_financial_statements.py::TestCoreModels::test_get_financial_year_march PASSED [ 87%]
tests/unit/test_services/test_financial_statements.py::TestCoreModels::test_get_financial_year_january PASSED [ 87%]
tests/unit/test_services/test_financial_statements.py::TestCoreModels::test_get_fy_dates PASSED [ 87%]
tests/unit/test_services/test_financial_statements.py::TestCoreModels::test_cash_flow_signed_amount_inflow PASSED [ 87%]
tests/unit/test_services/test_financial_statements.py::TestCoreModels::test_cash_flow_signed_amount_outflow PASSED [ 87%]
tests/unit/test_services/test_financial_statements.py::TestCoreModels::test_balance_sheet_net_worth PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestCoreModels::test_cash_flow_statement_properties PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestCashFlowStatementService::test_service_initialization PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestCashFlowStatementService::test_get_cash_flow_statement_empty PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestCashFlowStatementService::test_save_cash_flow_statement PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestCashFlowStatementService::test_classify_salary_transaction PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestBalanceSheetService::test_service_initialization PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestBalanceSheetService::test_get_balance_sheet_empty PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestBalanceSheetService::test_save_balance_sheet PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestPortfolioValuationService::test_service_initialization PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestPortfolioValuationService::test_get_portfolio_summary_empty PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestPortfolioValuationService::test_xirr_no_transactions PASSED [ 88%]
tests/unit/test_services/test_financial_statements.py::TestLiabilitiesService::test_service_initialization PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestLiabilitiesService::test_add_liability PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestLiabilitiesService::test_calculate_emi PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestLiabilitiesService::test_record_emi_payment PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestLiabilitiesService::test_record_prepayment PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestLiabilitiesService::test_get_loan_summary PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestLiabilitiesService::test_amortization_schedule PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestDatabaseSchema::test_cash_flows_table_exists PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestDatabaseSchema::test_liabilities_table_exists PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestDatabaseSchema::test_balance_sheet_snapshots_table_exists PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestDatabaseSchema::test_asset_holdings_snapshot_table_exists PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestDatabaseSchema::test_liability_transactions_table_exists PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestDatabaseSchema::test_cash_flow_statements_table_exists PASSED [ 89%]
tests/unit/test_services/test_financial_statements.py::TestDatabaseSchema::test_user_id_not_null_on_new_tables PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestDTAACalculator::test_calculator_initialization PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestDTAACalculator::test_treaty_rates_us PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestDTAACalculator::test_treaty_rates_uk PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestDTAACalculator::test_dtaa_articles_us PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestDTAACredit::test_credit_creation PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestDTAASummary::test_summary_creation PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestDTAASummary::test_summary_with_values PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestForm67Data::test_form67_creation PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestForm67Data::test_form67_relief_defaults PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestCalculateDividendCredit::test_dividend_credit_basic PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestCalculateDividendCredit::test_dividend_credit_limited_by_indian_tax PASSED [ 90%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestCalculateDividendCredit::test_dividend_credit_article_reference PASSED [ 91%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestCalculateInterestCredit::test_interest_credit_basic PASSED [ 91%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestGetCreditsForYear::test_get_credits_empty PASSED [ 91%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestGenerateForm67Data::test_generate_form67_empty PASSED [ 91%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestCountryNames::test_get_country_name_us PASSED [ 91%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestCountryNames::test_get_country_name_uk PASSED [ 91%]
tests/unit/test_services/test_foreign/test_dtaa_calculator.py::TestCountryNames::test_get_country_name_unknown PASSED [ 91%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPProcessor::test_processor_initialization PASSED [ 91%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPProcessor::test_ltcg_threshold_constant PASSED [ 91%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPProcessor::test_tcs_threshold_constant PASSED [ 91%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPProcessor::test_tcs_rate_constant PASSED [ 91%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestTCSTracking::test_tcs_tracking_creation PASSED [ 91%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestTCSTracking::test_tcs_below_threshold PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestTCSTracking::test_tcs_above_threshold PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestTCSTracking::test_tcs_multiple_remittances PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPLot::test_lot_creation PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPSaleResult::test_sale_result_creation PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPSaleResult::test_net_gain_property PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPAnnualSummary::test_summary_creation PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPPurchaseModel::test_purchase_creation PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPPurchaseModel::test_purchase_tcs_constants PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPPurchaseModel::test_purchase_calculate_perquisite PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPPurchaseModel::test_purchase_lrs_calculation PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPPurchaseModel::test_purchase_tcs_below_threshold PASSED [ 92%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPPurchaseModel::test_purchase_tcs_above_threshold PASSED [ 93%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPSaleModel::test_sale_creation PASSED [ 93%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPSaleModel::test_sale_ltcg_threshold PASSED [ 93%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPSaleModel::test_sale_calculate_gain_stcg PASSED [ 93%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestESPPSaleModel::test_sale_calculate_gain_ltcg PASSED [ 93%]
tests/unit/test_services/test_foreign/test_espp_processor.py::TestGetAnnualSummary::test_summary_empty PASSED [ 93%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUProcessor::test_processor_initialization PASSED [ 93%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUProcessor::test_ltcg_threshold_constant PASSED [ 93%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSULot::test_lot_creation PASSED [ 93%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUSaleResult::test_sale_result_creation PASSED [ 93%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUSaleResult::test_net_gain_property PASSED [ 93%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUAnnualSummary::test_summary_creation PASSED [ 93%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUVestModel::test_vest_creation PASSED [ 94%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUVestModel::test_vest_cost_basis_property PASSED [ 94%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUVestModel::test_vest_cost_basis_inr_without_rate PASSED [ 94%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUVestModel::test_vest_cost_basis_inr_with_rate PASSED [ 94%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUVestModel::test_vest_calculate_perquisite PASSED [ 94%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUSaleModel::test_sale_creation PASSED [ 94%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUSaleModel::test_sale_ltcg_threshold PASSED [ 94%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUSaleModel::test_sale_calculate_gain_stcg PASSED [ 94%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestRSUSaleModel::test_sale_calculate_gain_ltcg PASSED [ 94%]
tests/unit/test_services/test_foreign/test_rsu_processor.py::TestGetAnnualSummary::test_summary_empty PASSED [ 94%]
tests/unit/test_services/test_golden_reference.py::TestTruthResolver::test_default_truth_sources_loaded PASSED [ 94%]
tests/unit/test_services/test_golden_reference.py::TestTruthResolver::test_get_source_priority PASSED [ 94%]
tests/unit/test_services/test_golden_reference.py::TestTruthResolver::test_is_authoritative PASSED [ 94%]
tests/unit/test_services/test_golden_reference.py::TestTruthResolver::test_cost_basis_system_is_authoritative PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestTruthResolver::test_user_override PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestCrossCorrelator::test_reconcile_exact_match PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestCrossCorrelator::test_reconcile_within_tolerance PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestCrossCorrelator::test_reconcile_mismatch PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestCrossCorrelator::test_reconcile_missing_system PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestCrossCorrelator::test_reconcile_missing_golden PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestCrossCorrelator::test_severity_levels PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestReconciliationEvent::test_calculate_difference PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestReconciliationEvent::test_calculate_difference_zero_golden PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestGoldenHolding::test_reconciliation_key_isin PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestGoldenHolding::test_reconciliation_key_folio PASSED [ 95%]
tests/unit/test_services/test_golden_reference.py::TestGoldenHolding::test_value_inr_calculation PASSED [ 96%]
tests/unit/test_services/test_golden_reference.py::TestMultiCurrency::test_us_stock_value_conversion PASSED [ 96%]
tests/unit/test_services/test_golden_reference.py::TestMultiCurrency::test_reconcile_us_stocks_with_forex PASSED [ 96%]
tests/unit/test_services/test_golden_reference.py::TestReconciliationSummary::test_match_rate_calculation PASSED [ 96%]
tests/unit/test_services/test_golden_reference.py::TestReconciliationSummary::test_match_rate_empty PASSED [ 96%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestITR2Exporter::test_exporter_initialization PASSED [ 96%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestITR2Exporter::test_old_regime_slabs PASSED [ 96%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestITR2Exporter::test_new_regime_slabs PASSED [ 96%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestITR2Exporter::test_cess_rate PASSED [ 96%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestPersonalInfo::test_personal_info_creation PASSED [ 96%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestPersonalInfo::test_personal_info_defaults PASSED [ 96%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestSalaryIncome::test_salary_income_creation PASSED [ 96%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestSalaryIncome::test_salary_calculate PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestSalaryIncome::test_salary_standard_deduction PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestCapitalGains::test_capital_gains_creation PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestCapitalGains::test_capital_gains_calculate PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestCapitalGains::test_ltcg_exemption_default PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestOtherIncome::test_other_income_creation PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestOtherIncome::test_other_income_calculate PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestChapter6ADeductions::test_deductions_creation PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestChapter6ADeductions::test_deductions_calculate PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestChapter6ADeductions::test_deductions_80c_limit PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestTaxRelief::test_relief_creation PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestTaxRelief::test_relief_calculate PASSED [ 97%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestTDSDetails::test_tds_creation PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestITR2Data::test_itr2_data_creation PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestITR2Data::test_itr2_data_defaults PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestSlabTaxCalculation::test_calculate_slab_tax_below_exemption PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestSlabTaxCalculation::test_calculate_slab_tax_one_slab PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestSlabTaxCalculation::test_calculate_slab_tax_multiple_slabs PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestSurchargeCalculation::test_no_surcharge_below_50l PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestSurchargeCalculation::test_surcharge_50l_to_1cr PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestExportJSON::test_export_json_creates_file PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestExportJSON::test_to_json_dict PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestGenerateITR2::test_generate_empty PASSED [ 98%]
tests/unit/test_services/test_itr/test_itr2_exporter.py::TestGenerateITR2::test_assessment_year_calculation PASSED [ 98%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestScheduleFAGenerator::test_generator_initialization PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestScheduleFAGenerator::test_country_codes PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestForeignAccount::test_account_creation PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestForeignAccount::test_account_default_values PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestForeignCustodialAccount::test_custodial_account_creation PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestForeignEquityHolding::test_equity_holding_creation PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestForeignEquityHolding::test_equity_holding_defaults PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestScheduleFAData::test_schedule_fa_creation PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestScheduleFAData::test_schedule_fa_calculate_totals_empty PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestScheduleFAData::test_schedule_fa_calculate_totals_with_data PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestGenerateScheduleFA::test_generate_empty PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestGenerateScheduleFA::test_assessment_year_calculation PASSED [ 99%]
tests/unit/test_services/test_itr/test_schedule_fa.py::TestSaveScheduleFA::test_to_json PASSED [100%]

=================================== FAILURES ===================================
__________________ TestEPFParser.test_epf_save_to_db[Sanjay] ___________________
src/pfas/parsers/epf/epf.py:431: in save_to_db
    if self._insert_transaction(epf_account_id, txn, result.source_file, user_id):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/pfas/parsers/epf/epf.py:557: in _insert_transaction
    self.conn.execute(
E   sqlcipher3.dbapi2.IntegrityError: FOREIGN KEY constraint failed

The above exception was the direct cause of the following exception:
tests/integration/test_epf_integration.py:78: in test_epf_save_to_db
    count = parser.save_to_db(result, user_id=test_user_id)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/pfas/parsers/epf/epf.py:449: in save_to_db
    raise Exception(f"Failed to save EPF data: {e}") from e
E   Exception: Failed to save EPF data: FOREIGN KEY constraint failed
---------------------------- Captured stdout setup -----------------------------

[FIXTURE] Selected EPF file from inbox: 2026-01-17_Sanjay_APHYD00476720000003193_2025.pdf
------------------------------ Captured log call -------------------------------
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
_________________ TestCAMSParser.test_cams_save_to_db[Sanjay] __________________
tests/integration/test_mf_cams_integration.py:46: in test_cams_save_to_db
    assert cursor.fetchone()['cnt'] == count
E   assert 0 == 7
---------------------------- Captured stdout setup -----------------------------

[FIXTURE] Selected CAMS file from inbox: CAMS_Sanjay_CAMS_CG_FY2024-25_v2.xlsx
------------------------------ Captured log call -------------------------------
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
ERROR    pfas.core.transaction_service:transaction_service.py:388 Transaction failed: cannot start a transaction within a transaction
Traceback (most recent call last):
  File "/home/sshankar/projects/pfas-project/src/pfas/core/transaction_service.py", line 296, in record
    cursor.execute("BEGIN IMMEDIATE")
sqlcipher3.dbapi2.OperationalError: cannot start a transaction within a transaction
__________________ TestNPSParser.test_nps_parse_basic[Sanjay] __________________
tests/integration/test_nps_integration.py:20: in test_nps_parse_basic
    assert result.success, f"Parse failed: {result.errors}"
E   AssertionError: Parse failed: ['Unsupported file format: .pdf']
E   assert False
E    +  where False = ParseResult(success=False, account=None, transactions=[], errors=['Unsupported file format: .pdf'], warnings=[], source_file='/home/sshankar/projects/pfas-project/Data/Users/Sanjay/inbox/NPS/1101211424_Mar2025.pdf').success
---------------------------- Captured stdout setup -----------------------------

[FIXTURE] Selected NPS file from inbox: 1101211424_Mar2025.pdf
_______________ TestMFReconciler.test_save_reconciliation_result _______________
tests/unit/test_analyzers/test_mf_enhanced.py:525: in test_save_reconciliation_result
    recon_id = reconciler.save_result(result)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/pfas/analyzers/mf_reconciler.py:406: in save_result
    cursor = self.conn.execute("""
E   sqlite3.OperationalError: no such column: updated_at
__________________ TestFileArchiver.test_archive_single_file ___________________
tests/unit/test_phase1/test_archiver.py:61: in test_archive_single_file
    assert archived_path.exists()
           ^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'tuple' object has no attribute 'exists'
------------------------------ Captured log call -------------------------------
INFO     pfas.services.archiver:archiver.py:178 Archived: cas_statement.pdf -> /tmp/tmpi7f0cr2d/archive/Mutual-Fund/CAMS/2026-01-30_Sanjay_CAMS_cas_statement.pdf
INFO     pfas.core.manifest:manifest.py:360 Added manifest entry: 2026-01-30_Sanjay_CAMS_cas_statement.pdf (sha256:bb2d4cea2b5ae...)
______________ TestFileArchiver.test_archive_preserves_structure _______________
tests/unit/test_phase1/test_archiver.py:78: in test_archive_preserves_structure
    assert "Mutual-Fund" in str(archived_path.parent)
                                ^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'tuple' object has no attribute 'parent'
------------------------------ Captured log call -------------------------------
INFO     pfas.services.archiver:archiver.py:178 Archived: cas_statement.pdf -> /tmp/tmp56inubfl/archive/Mutual-Fund/CAMS/2026-01-30_Sanjay_CAMS_cas_statement.pdf
INFO     pfas.core.manifest:manifest.py:360 Added manifest entry: 2026-01-30_Sanjay_CAMS_cas_statement.pdf (sha256:bb2d4cea2b5ae...)
_______________ TestFileArchiver.test_archive_naming_convention ________________
tests/unit/test_phase1/test_archiver.py:89: in test_archive_naming_convention
    name = archived_path.name
           ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'tuple' object has no attribute 'name'
------------------------------ Captured log call -------------------------------
INFO     pfas.services.archiver:archiver.py:178 Archived: cas_statement.pdf -> /tmp/tmpxrjifa9c/archive/Mutual-Fund/CAMS/2026-01-30_Sanjay_CAMS_cas_statement.pdf
INFO     pfas.core.manifest:manifest.py:360 Added manifest entry: 2026-01-30_Sanjay_CAMS_cas_statement.pdf (sha256:bb2d4cea2b5ae...)
____________ TestFileArchiver.test_archive_handles_duplicate_names _____________
tests/unit/test_phase1/test_archiver.py:114: in test_archive_handles_duplicate_names
    assert archived1.exists()
           ^^^^^^^^^^^^^^^^
E   AttributeError: 'tuple' object has no attribute 'exists'
------------------------------ Captured log call -------------------------------
INFO     pfas.services.archiver:archiver.py:178 Archived: statement.pdf -> /tmp/tmpf3ytb77h/archive/Mutual-Fund/CAMS/2026-01-30_Sanjay_CAMS_statement.pdf
INFO     pfas.core.manifest:manifest.py:360 Added manifest entry: 2026-01-30_Sanjay_CAMS_statement.pdf (sha256:d0b425e00e15a...)
INFO     pfas.services.archiver:archiver.py:178 Archived: statement.pdf -> /tmp/tmpf3ytb77h/archive/Mutual-Fund/KARVY/2026-01-30_Sanjay_KARVY_statement.pdf
INFO     pfas.core.manifest:manifest.py:360 Added manifest entry: 2026-01-30_Sanjay_KARVY_statement.pdf (sha256:dab741b6289e7...)
____________ TestFileArchiver.test_archive_detects_source_from_path ____________
tests/unit/test_phase1/test_archiver.py:153: in test_archive_detects_source_from_path
    assert "_CAMS_" in archived_path.name
                       ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'tuple' object has no attribute 'name'
------------------------------ Captured log call -------------------------------
INFO     pfas.services.archiver:archiver.py:178 Archived: cas_statement.pdf -> /tmp/tmp84nxai93/archive/Mutual-Fund/CAMS/2026-01-30_Sanjay_CAMS_cas_statement.pdf
INFO     pfas.core.manifest:manifest.py:360 Added manifest entry: 2026-01-30_Sanjay_CAMS_cas_statement.pdf (sha256:bb2d4cea2b5ae...)
=========================== short test summary info ============================
SKIPPED [1] tests/integration/test_nps_integration.py:49: No data to save: ['Unsupported file format: .pdf']
SKIPPED [1] tests/integration/test_ppf_integration.py:25: PPF file corrupted or empty: Excel file has no worksheets (corrupted or empty): 2026-01-17_Sanjay_FY24-25-PPF-Sanjay.xlsx
SKIPPED [1] tests/integration/test_ppf_integration.py:55: No data to save: ['Excel file has no worksheets (corrupted or empty): 2026-01-17_Sanjay_FY24-25-PPF-Sanjay.xlsx']
SKIPPED [1] tests/integration/test_stock_integration.py:44: Database connection closed - session fixture cleanup in progress
SKIPPED [1] tests/integration/test_full_fy.py:20: Database connection closed - session fixture cleanup in progress
SKIPPED [1] tests/integration/test_full_fy.py:30: Database connection closed - session fixture cleanup in progress
SKIPPED [1] tests/integration/test_full_fy.py:39: Database connection closed - session fixture cleanup in progress
SKIPPED [1] tests/integration/test_full_fy.py:48: Database connection closed - session fixture cleanup in progress
SKIPPED [1] tests/integration/test_full_fy.py:62: Database connection closed - session fixture cleanup in progress
SKIPPED [1] tests/integration/test_full_fy.py:69: Database connection closed - session fixture cleanup in progress
SKIPPED [1] tests/integration/test_full_fy.py:79: Database connection closed - session fixture cleanup in progress
SKIPPED [1] tests/unit/test_services/test_encrypted_file_handler.py:265: Requires pdfplumber to be installed
SKIPPED [1] tests/unit/test_services/test_encrypted_file_handler.py:272: Requires PyPDF2 to be installed
FAILED tests/integration/test_epf_integration.py::TestEPFParser::test_epf_save_to_db[Sanjay]
FAILED tests/integration/test_mf_cams_integration.py::TestCAMSParser::test_cams_save_to_db[Sanjay]
FAILED tests/integration/test_nps_integration.py::TestNPSParser::test_nps_parse_basic[Sanjay]
FAILED tests/unit/test_analyzers/test_mf_enhanced.py::TestMFReconciler::test_save_reconciliation_result
FAILED tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_single_file
FAILED tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_preserves_structure
FAILED tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_naming_convention
FAILED tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_handles_duplicate_names
FAILED tests/unit/test_phase1/test_archiver.py::TestFileArchiver::test_archive_detects_source_from_path
============ 9 failed, 1197 passed, 13 skipped in 115.00s (0:01:54) ============
